"use strict";var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,isArray=function(arr){return"function"==typeof Array.isArray?Array.isArray(arr):"[object Array]"===toStr.call(arr)},isPlainObject=function(obj){if(!obj||"[object Object]"!==toStr.call(obj))return!1;var hasOwnConstructor=hasOwn.call(obj,"constructor"),hasIsPrototypeOf=obj.constructor&&obj.constructor.prototype&&hasOwn.call(obj.constructor.prototype,"isPrototypeOf");if(obj.constructor&&!hasOwnConstructor&&!hasIsPrototypeOf)return!1;var key;for(key in obj);return"undefined"==typeof key||hasOwn.call(obj,key)},extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0],i=1,length=arguments.length,deep=!1;for("boolean"==typeof target?(deep=target,target=arguments[1]||{},i=2):("object"!=typeof target&&"function"!=typeof target||null===target)&&(target={});length>i;++i)if(options=arguments[i],null!==options)for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(isPlainObject(copy)||(copyIsArray=isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&isArray(src)?src:[]):clone=src&&isPlainObject(src)?src:{},target[name]=extend(deep,clone,copy)):"undefined"!=typeof copy&&(target[name]=copy));return target},QJ=function(selector){return QJ.isDOMElement(selector)?document.querySelectorAll(selector):selector};QJ.isDOMElement=function(el){var is=el&&null!==el.nodeName;return is};var rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;QJ.trim=function(text){return null===text?"":(text+"").replace(rtrim,"")};var rreturn=/\r/g;QJ.val=function(el,val){var ret;return arguments.length>1?(el.value=val,el.value):(ret=el.value,"string"==typeof ret?ret.replace(rreturn,""):null===ret?"":ret)},QJ.preventDefault=function(eventObject){return"function"==typeof eventObject.preventDefault?void eventObject.preventDefault():(eventObject.returnValue=!1,!1)},QJ.normalizeEvent=function(e){var original;return original=e,e={which:null!==original.which?original.which:void 0,target:original.target||original.srcElement,preventDefault:function(){return QJ.preventDefault(original)},originalEvent:original,data:original.data||original.detail},null===e.which&&(e.which=null!==original.charCode?original.charCode:original.keyCode),e},QJ.on=function(element,eventName,callback){var el,i,j,len,len1,multEventName,originalCallback,ref;if(element.length)for(i=0,len=element.length;len>i;i++)el=element[i],QJ.on(el,eventName,callback);else{if(!eventName.match(" "))return originalCallback=callback,callback=function(e){return e=QJ.normalizeEvent(e),originalCallback(e)},element.addEventListener?element.addEventListener(eventName,callback,!1):element.attachEvent?(eventName="on"+eventName,element.attachEvent(eventName,callback)):void(element["on"+eventName]=callback);for(ref=eventName.split(" "),j=0,len1=ref.length;len1>j;j++)multEventName=ref[j],QJ.on(element,multEventName,callback)}},QJ.addClass=function(el,className){var e;return el.length?function(){var i,len,results;for(results=[],i=0,len=el.length;len>i;i++)e=el[i],results.push(QJ.addClass(e,className));return results}():el.classList?el.classList.add(className):el.className+=" "+className},QJ.hasClass=function(el,className){var e,hasClass,i,len;if(el.length){for(hasClass=!0,i=0,len=el.length;len>i;i++)e=el[i],hasClass=hasClass&&QJ.hasClass(e,className);return hasClass}return el.classList?el.classList.contains(className):new RegExp("(^| )"+className+"( |$)","gi").test(el.className)},QJ.removeClass=function(el,className){var cls,e,i,len,ref,results;if(el.length)return function(){var i,len,results;for(results=[],i=0,len=el.length;len>i;i++)e=el[i],results.push(QJ.removeClass(e,className));return results}();if(el.classList){for(ref=className.split(" "),results=[],i=0,len=ref.length;len>i;i++)cls=ref[i],results.push(el.classList.remove(cls));return results}return el.className=el.className.replace(new RegExp("(^|\\b)"+className.split(" ").join("|")+"(\\b|$)","gi")," "),el.className},QJ.toggleClass=function(el,className,bool){var e;return el.length?function(){var i,len,results;for(results=[],i=0,len=el.length;len>i;i++)e=el[i],results.push(QJ.toggleClass(e,className,bool));return results}():bool?QJ.hasClass(el,className)?void 0:QJ.addClass(el,className):QJ.removeClass(el,className)},QJ.append=function(el,toAppend){var e;return el.length?function(){var i,len,results;for(results=[],i=0,len=el.length;len>i;i++)e=el[i],results.push(QJ.append(e,toAppend));return results}():el.insertAdjacentHTML("beforeend",toAppend)},QJ.find=function(el,selector){return(el instanceof NodeList||el instanceof Array)&&(el=el[0]),el.querySelectorAll(selector)},QJ.trigger=function(el,name,data){var e,ev;try{ev=new CustomEvent(name,{detail:data})}catch(err){e=err,ev=document.createEvent("CustomEvent"),ev.initCustomEvent?ev.initCustomEvent(name,!0,!0,data):ev.initEvent(name,!0,!0,data)}return el.dispatchEvent(ev)};var getIndex=[].getIndex||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1},defaultFormat=/(\d{1,4})/g,cards=[{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"dankort",pattern:/^5019/,format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:defaultFormat,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:defaultFormat,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5018|5020|5038|6304|6703|6759|676[1-3])/,format:defaultFormat,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:defaultFormat,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"elo",pattern:/^4011|438935|45(1416|76|7393)|50(4175|6699|67|90[4-7])|63(6297|6368)/,format:defaultFormat,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:defaultFormat,length:[13,16,19],cvcLength:[3],luhn:!0}],cardFromNumber=function(num){var card,i,len;for(num=(num+"").replace(/\D/g,""),i=0,len=cards.length;len>i;i++)if(card=cards[i],card.pattern.test(num))return card},cardFromType=function(type){var card,i,len;for(i=0,len=cards.length;len>i;i++)if(card=cards[i],card.type===type)return card},luhnCheck=function(num){var digit,digits,i,len,odd,sum;for(odd=!0,sum=0,digits=(num+"").split("").reverse(),i=0,len=digits.length;len>i;i++)digit=digits[i],digit=parseInt(digit,10),(odd=!odd)&&(digit*=2),digit>9&&(digit-=9),sum+=digit;return sum%10===0},hasTextSelected=function(target){var e,ref;try{if(null!==target.selectionStart&&target.selectionStart!==target.selectionEnd)return!0;if(null!==("undefined"!=typeof document&&null!==document&&null!==(ref=document.selection)?ref.createRange:void 0)&&document.selection.createRange().text)return!0}catch(err){return e=err,!1}return!1},formatCardNumber=function(e){var card,digit,length,re,target,upperLength,value;return digit=String.fromCharCode(e.which),!/^\d+$/.test(digit)||(target=e.target,value=QJ.val(target),card=cardFromNumber(value+digit),length=(value.replace(/\D/g,"")+digit).length,upperLength=16,card&&(upperLength=card.length[card.length.length-1]),length>=upperLength||hasTextSelected(target))?void 0:(re=card&&"amex"===card.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,re.test(value)?(e.preventDefault(),QJ.val(target,value+" "+digit)):re.test(value+digit)?(e.preventDefault(),QJ.val(target,value+digit+" ")):void 0)},formatBackCardNumber=function(e){var target,value;return target=e.target,value=QJ.val(target),e.meta||8!==e.which||hasTextSelected(target)?void 0:/\d\s$/.test(value)?(e.preventDefault(),QJ.val(target,value.replace(/\d\s$/,""))):/\s\d?$/.test(value)?(e.preventDefault(),QJ.val(target,value.replace(/\s\d?$/,""))):void 0},formatExpiry=function(e){var digit,target,val;return digit=String.fromCharCode(e.which),/^\d+$/.test(digit)?(target=e.target,val=QJ.val(target)+digit,/^\d$/.test(val)&&"0"!==val&&"1"!==val?(e.preventDefault(),QJ.val(target,"0"+val+" / ")):/^\d\d$/.test(val)?(e.preventDefault(),QJ.val(target,val+" / ")):void 0):void 0},formatMonthExpiry=function(e){var digit,target,val;return digit=String.fromCharCode(e.which),/^\d+$/.test(digit)?(target=e.target,val=QJ.val(target)+digit,/^\d$/.test(val)&&"0"!==val&&"1"!==val?(e.preventDefault(),QJ.val(target,"0"+val)):/^\d\d$/.test(val)?(e.preventDefault(),QJ.val(target,""+val)):void 0):void 0},formatForwardExpiry=function(e){var digit,target,val;return digit=String.fromCharCode(e.which),/^\d+$/.test(digit)?(target=e.target,val=QJ.val(target),/^\d\d$/.test(val)?QJ.val(target,val+" / "):void 0):void 0},formatForwardSlash=function(e){var slash,target,val;return slash=String.fromCharCode(e.which),"/"===slash?(target=e.target,val=QJ.val(target),/^\d$/.test(val)&&"0"!==val?QJ.val(target,"0"+val+" / "):void 0):void 0},formatBackExpiry=function(e){var target,value;if(!e.metaKey&&(target=e.target,value=QJ.val(target),8===e.which&&!hasTextSelected(target)))return/\d(\s|\/)+$/.test(value)?(e.preventDefault(),QJ.val(target,value.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(value)?(e.preventDefault(),QJ.val(target,value.replace(/\s\/\s?\d?$/,""))):void 0},restrictNumeric=function(e){var input;return e.metaKey||e.ctrlKey?!0:32===e.which?e.preventDefault():0===e.which?!0:e.which<33?!0:(input=String.fromCharCode(e.which),/[\d\s]/.test(input)?void 0:e.preventDefault())},restrictCardNumber=function(e){var card,digit,target,value;if(target=e.target,digit=String.fromCharCode(e.which),/^\d+$/.test(digit)&&!hasTextSelected(target))if(value=(QJ.val(target)+digit).replace(/\D/g,""),card=cardFromNumber(value)){var isLongEnough=value.length<=card.length[card.length.length-1];if(!isLongEnough)return e.preventDefault()}else{var isTooLong=value.length<=16;if(!isTooLong)return e.preventDefault()}},restrictExpiry=function(e,length){var digit,target,value;return target=e.target,digit=String.fromCharCode(e.which),/^\d+$/.test(digit)&&!hasTextSelected(target)?(value=QJ.val(target)+digit,value=value.replace(/\D/g,""),value.length>length?e.preventDefault():void 0):void 0},restrictCombinedExpiry=function(e){return restrictExpiry(e,6)},restrictMonthExpiry=function(e){return restrictExpiry(e,2)},restrictYearExpiry=function(e){return restrictExpiry(e,4)},restrictCVC=function(e){var digit,target,val;if(target=e.target,digit=String.fromCharCode(e.which),/^\d+$/.test(digit)&&!hasTextSelected(target)){val=QJ.val(target)+digit;var isLessThanFour=val.length<=4;return isLessThanFour?void 0:e.preventDefault()}},Payment=function(){},reFormatCardNumber=function(e){return setTimeout(function(_this){return function(){var target,value;return target=e.target,value=QJ.val(target),value=Payment.fns.formatCardNumber(value),QJ.val(target,value),QJ.trigger(target,"change")}}(this))},setCardType=function(e){var allTypes,card,cardType,target,val;return target=e.target,val=QJ.val(target),cardType=Payment.fns.cardType(val)||"unknown",QJ.hasClass(target,cardType)?void 0:(allTypes=function(){var i,len,results;for(results=[],i=0,len=cards.length;len>i;i++)card=cards[i],results.push(card.type);return results}(),QJ.removeClass(target,"unknown"),QJ.removeClass(target,allTypes.join(" ")),QJ.addClass(target,cardType),QJ.toggleClass(target,"identified","unknown"!==cardType),QJ.trigger(target,"payment.cardType",cardType))};Payment.fns={cardExpiryVal:function(value){var month,prefix,ref,year;return value=value.replace(/\s/g,""),ref=value.split("/",2),month=ref[0],year=ref[1],2===(null!==year?year.length:void 0)&&/^\d+$/.test(year)&&(prefix=(new Date).getFullYear(),prefix=prefix.toString().slice(0,2),year=prefix+year),month=parseInt(month,10),year=parseInt(year,10),{month:month,year:year}},validateCardNumber:function(num){var card,ref;return num=(num+"").replace(/\s+|-/g,""),/^\d+$/.test(num)?(card=cardFromNumber(num),card?(ref=num.length,getIndex.call(card.length,ref)>=0&&(card.luhn===!1||luhnCheck(num))):!1):!1},validateCardExpiry:function(month,year){var currentTime,expiry,prefix,ref;return"object"==typeof month&&"month"in month&&(ref=month,month=ref.month,year=ref.year),month&&year?(month=QJ.trim(month),year=QJ.trim(year),/^\d+$/.test(month)&&/^\d+$/.test(year)?(month=parseInt(month,10),month&&12>=month?(2===year.length&&(prefix=(new Date).getFullYear(),prefix=prefix.toString().slice(0,2),year=prefix+year),expiry=new Date(year,month),currentTime=new Date,expiry.setMonth(expiry.getMonth()-1),expiry.setMonth(expiry.getMonth()+1,1),expiry>currentTime):!1):!1):!1},validateCardCVC:function(cvc,type){var ref,ref1;return cvc=QJ.trim(cvc),/^\d+$/.test(cvc)?type&&cardFromType(type)?(ref=cvc.length,getIndex.call(null!==(ref1=cardFromType(type))?ref1.cvcLength:void 0,ref)>=0):cvc.length>=3&&cvc.length<=4:!1},cardType:function(num){var ref;return num?(null!==(ref=cardFromNumber(num))?ref.type:void 0)||null:null},formatCardNumber:function(num){var card,groups,ref,upperLength;return(card=cardFromNumber(num))?(upperLength=card.length[card.length.length-1],num=num.replace(/\D/g,""),num=num.slice(0,+upperLength+1||9e9),card.format.global?null!==(ref=num.match(card.format))?ref.join(" "):void 0:(groups=card.format.exec(num),null!==groups&&groups.shift(),null!==groups?groups.join(" "):void 0)):num}},Payment.restrictNumeric=function(el){return QJ.on(el,"keypress",restrictNumeric)},Payment.cardExpiryVal=function(el){return Payment.fns.cardExpiryVal(QJ.val(el))},Payment.formatCardCVC=function(el){return Payment.restrictNumeric(el),QJ.on(el,"keypress",restrictCVC),el},Payment.formatCardExpiry=function(el){var month,year;return Payment.restrictNumeric(el),el.length&&2===el.length?(month=el[0],year=el[1],this.formatCardExpiryMultiple(month,year)):(QJ.on(el,"keypress",restrictCombinedExpiry),QJ.on(el,"keypress",formatExpiry),QJ.on(el,"keypress",formatForwardSlash),QJ.on(el,"keypress",formatForwardExpiry),QJ.on(el,"keydown",formatBackExpiry)),el},Payment.formatCardExpiryMultiple=function(month,year){return QJ.on(month,"keypress",restrictMonthExpiry),QJ.on(month,"keypress",formatMonthExpiry),QJ.on(year,"keypress",restrictYearExpiry)},Payment.formatCardNumber=function(el){return Payment.restrictNumeric(el),QJ.on(el,"keypress",restrictCardNumber),QJ.on(el,"keypress",formatCardNumber),QJ.on(el,"keydown",formatBackCardNumber),QJ.on(el,"keyup",setCardType),QJ.on(el,"paste",reFormatCardNumber),el},Payment.getCardArray=function(){return cards},Payment.setCardArray=function(cardArray){return cards=cardArray,!0},Payment.addToCardArray=function(cardObject){return cards.push(cardObject)},Payment.removeFromCardArray=function(type){var key,value;for(key in cards)value=cards[key],value.type===type&&cards.splice(key,1);return!0};var Card=function(opts){if(void 0===opts);else{if(this.options=extend(!0,this.defaults,opts),!this.options.form)return void console.log("Please provide a form");if(this.$el=QJ(this.options.form),!this.options.container)return void console.log("Please provide a container");this.$container=QJ(this.options.container),this.render(),this.attachHandlers(),this.handleInitialPlaceholders()}return Card};Card.prototype.bindVal=function(el,out,opts){var joiner,o,outDefaults;null===opts&&(opts={}),opts.fill=opts.fill||!1,opts.filters=opts.filters||[],opts.filters instanceof Array||(opts.filters=[opts.filters]),opts.join=opts.join||"";var isFunction="function"==typeof opts.join;return isFunction||(joiner=opts.join,opts.join=function(){return joiner}),outDefaults=function(){var j,len,results;for(results=[],j=0,len=out.length;len>j;j++)o=out[j],results.push(o.textContent);return results}(),QJ.on(el,"focus",function(){return QJ.addClass(out,"jp-card-focused")}),QJ.on(el,"blur",function(){return QJ.removeClass(out,"jp-card-focused")}),QJ.on(el,"keyup change paste",function(e){var elem,filter,i,j,join,k,len,len1,outEl,outVal,ref,results,val;for(val=function(){var j,len,results;for(results=[],j=0,len=el.length;len>j;j++)elem=el[j],results.push(QJ.val(elem));return results}(),join=opts.join(val),val=val.join(join),val===join&&(val=""),ref=opts.filters,j=0,len=ref.length;len>j;j++)filter=ref[j],val=filter(val,el,out);for(results=[],i=k=0,len1=out.length;len1>k;i=++k)outEl=out[i],outVal=opts.fill?val+outDefaults[i].substring(val.length):val||outDefaults[i],results.push(outEl.textContent=outVal);return results}),el},Card.prototype.cardTemplate='<div class="jp-card-container"><div class="jp-card"><div class="jp-card-front"><div class="jp-card-logo jp-card-elo"><div class="e">e</div><div class="l">l</div><div class="o">o</div></div><div class="jp-card-logo jp-card-visa">visa</div><div class="jp-card-logo jp-card-mastercard">MasterCard</div><div class="jp-card-logo jp-card-maestro">Maestro</div><div class="jp-card-logo jp-card-amex"></div><div class="jp-card-logo jp-card-discover">discover</div><div class="jp-card-logo jp-card-dankort"><div class="dk"><div class="d"></div><div class="k"></div></div></div><div class="jp-card-lower"><div class="jp-card-shiny"></div><div class="jp-card-cvc jp-card-display">{{cvc}}</div><div class="jp-card-number jp-card-display">{{number}}</div><div class="jp-card-name jp-card-display">{{name}}</div><div class="jp-card-expiry jp-card-display" data-before="{{monthYear}}" data-after="{{validDate}}">{{expiry}}</div></div></div><div class="jp-card-back"><div class="jp-card-bar"></div><div class="jp-card-cvc jp-card-display">{{cvc}}</div><div class="jp-card-shiny"></div></div></div></div>',Card.prototype.template=function(tpl,data){return tpl.replace(/\{\{(.*?)\}\}/g,function(match,key,str){return data[key]})},Card.prototype.cardTypes=["jp-card-amex","jp-card-dankort","jp-card-dinersclub","jp-card-discover","jp-card-jcb","jp-card-laser","jp-card-maestro","jp-card-mastercard","jp-card-unionpay","jp-card-visa","jp-card-visaelectron","jp-card-elo"],Card.prototype.defaults={formatting:!0,formSelectors:{numberInput:'input[name="number"]',expiryInput:'input[name="expiry"]',cvcInput:'input[name="cvc"]',nameInput:'input[name="name"]'},cardSelectors:{cardContainer:".jp-card-container",card:".jp-card",numberDisplay:".jp-card-number",expiryDisplay:".jp-card-expiry",cvcDisplay:".jp-card-cvc",nameDisplay:".jp-card-name"},messages:{validDate:"valid\nthru",monthYear:"month/year"},placeholders:{number:"&bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull; &bull;&bull;&bull;&bull;",cvc:"&bull;&bull;&bull;",expiry:"&bull;&bull;/&bull;&bull;",name:"Full Name"},classes:{valid:"jp-card-valid",invalid:"jp-card-invalid"},debug:!1},Card.prototype.render=function(){var $cardContainer,baseWidth,name,obj,ref,ref1,selector,ua;QJ.append(this.$container,this.template(this.cardTemplate,extend({},this.options.messages,this.options.placeholders))),ref=this.options.cardSelectors;for(name in ref)selector=ref[name],this["$"+name]=QJ.find(this.$container,selector);ref1=this.options.formSelectors;for(name in ref1)selector=ref1[name],selector=this.options[name]?this.options[name]:selector,obj=QJ.find(this.$el,selector),!obj.length&&this.options.debug&&console.error("Card can't find a "+name+" in your form."),this["$"+name]=obj;return this.options.formatting&&(Payment.formatCardNumber(this.$numberInput),Payment.formatCardCVC(this.$cvcInput),Payment.formatCardExpiry(this.$expiryInput)),this.options.width&&($cardContainer=QJ(this.options.cardSelectors.cardContainer)[0],baseWidth=parseInt($cardContainer.clientWidth),$cardContainer.style.transform="scale("+this.options.width/baseWidth+")"),("undefined"!=typeof navigator&&null!==navigator?navigator.userAgent:void 0)&&(ua=navigator.userAgent.toLowerCase(),-1!==ua.indexOf("safari")&&-1===ua.indexOf("chrome")&&QJ.addClass(this.$card,"jp-card-safari")),/MSIE 10\./i.test(navigator.userAgent)&&QJ.addClass(this.$card,"jp-card-ie-10"),/rv:11.0/i.test(navigator.userAgent)?QJ.addClass(this.$card,"jp-card-ie-11"):void 0},Card.prototype.attachHandlers=function(){var expiryFilters;return this.bindVal(this.$numberInput,this.$numberDisplay,{fill:!1,filters:this.validToggler("cardNumber")}),QJ.on(this.$numberInput,"payment.cardType",this.handle("setCardType")),expiryFilters=[function(val){return val.replace(/(\s+)/g,"")}],expiryFilters.push(this.validToggler("cardExpiry")),this.bindVal(this.$expiryInput,this.$expiryDisplay,{join:function(text){return 2===text[0].length||text[1]?"/":""},filters:expiryFilters}),this.bindVal(this.$cvcInput,this.$cvcDisplay,{filters:this.validToggler("cardCVC")}),QJ.on(this.$cvcInput,"focus",this.handle("flipCard")),QJ.on(this.$cvcInput,"blur",this.handle("unflipCard")),this.bindVal(this.$nameInput,this.$nameDisplay,{fill:!1,filters:this.validToggler("cardHolderName"),join:" "})},Card.prototype.handleInitialPlaceholders=function(){var el,name,ref,results,selector;ref=this.options.formSelectors,results=[];for(name in ref)selector=ref[name],el=this["$"+name],QJ.val(el)?(QJ.trigger(el,"paste"),results.push(QJ.trigger(el,"keyup"))):results.push(void 0);return results},Card.prototype.handle=function(fn){return function(_this){return function(e){var args;return args=Array.prototype.slice.call(arguments),args.unshift(e.target),_this.handlers[fn].apply(_this,args)}}(this)},Card.prototype.validToggler=function(validatorName){var isValid;return"cardExpiry"===validatorName?isValid=function(val){var objVal;return objVal=Payment.fns.cardExpiryVal(val),Payment.fns.validateCardExpiry(objVal.month,objVal.year)}:"cardCVC"===validatorName?isValid=function(_this){return function(val){return Payment.fns.validateCardCVC(val,_this.cardType)}}(this):"cardNumber"===validatorName?isValid=function(val){return Payment.fns.validateCardNumber(val)}:"cardHolderName"===validatorName&&(isValid=function(val){return""!==val}),function(_this){return function(val,$in,$out){var result;return result=isValid(val),_this.toggleValidClass($in,result),_this.toggleValidClass($out,result),val}}(this)},Card.prototype.toggleValidClass=function(el,test){return QJ.toggleClass(el,this.options.classes.valid,test),QJ.toggleClass(el,this.options.classes.invalid,!test)},Card.prototype.handlers={setCardType:function($el,e){var cardType;return cardType=e.data,QJ.hasClass(this.$card,cardType)?void 0:(QJ.removeClass(this.$card,"jp-card-unknown"),QJ.removeClass(this.$card,this.cardTypes.join(" ")),QJ.addClass(this.$card,"jp-card-"+cardType),QJ.toggleClass(this.$card,"jp-card-identified","unknown"!==cardType),this.cardType=cardType,this.cardType)},flipCard:function(){return QJ.addClass(this.$card,"jp-card-flipped")},unflipCard:function(){return QJ.removeClass(this.$card,"jp-card-flipped")}},angular.module("ssm.card",[]).controller("CardCtrl",["$scope",function($scope){}]).directive("card",["$compile",function($compile){return{restrict:"A",scope:{cardContainer:"@",width:"@",placeholders:"=",options:"=",messages:"="},controller:"CardCtrl",link:function(scope,element,attributes,cardCtrl){var defaultPlaceholders={number:"•••• •••• •••• ••••",name:"Full Name",expiry:"••/••",cvc:"•••"},defaultMessages={validDate:"valid\nthru",monthYear:"month/year"},defaultOptions={debug:!1,formatting:!0},placeholders=angular.extend(defaultPlaceholders,scope.placeholders),messages=angular.extend(defaultMessages,scope.messages),options=angular.extend(defaultOptions,scope.options),opts={form:'[name="'+attributes.name+'"]',container:scope.cardContainer,formSelectors:{},width:scope.width||350,messages:{validDate:messages.validDate,monthYear:messages.monthYear},placeholders:{number:placeholders.number,name:placeholders.name,expiry:placeholders.expiry,cvc:placeholders.cvc},formatting:options.formatting,debug:options.debug};cardCtrl.numberInput&&cardCtrl.numberInput.length>0&&(opts.formSelectors.numberInput='input[name="'+cardCtrl.numberInput[0].name+'"]'),cardCtrl.expiryInput&&cardCtrl.expiryInput.length>0&&(opts.formSelectors.expiryInput='input[name="'+cardCtrl.expiryInput[0].name+'"]'),cardCtrl.cvcInput&&cardCtrl.cvcInput.length>0&&(opts.formSelectors.cvcInput='input[name="'+cardCtrl.cvcInput[0].name+'"]'),cardCtrl.nameInput&&cardCtrl.nameInput.length>0&&(opts.formSelectors.nameInput='input[name="'+cardCtrl.nameInput[0].name+'"]'),new Card(opts)}}}]).directive("cardNumber",["$compile",function($compile){return{restrict:"A",scope:{ngModel:"="},require:["^card","ngModel"],link:function(scope,element,attributes,ctrls){var cardCtrl=ctrls[0];cardCtrl.numberInput=element,scope.$watch("ngModel",function(newVal,oldVal){if((oldVal||newVal)&&(oldVal!==newVal||newVal)){var evt=document.createEvent("HTMLEvents");evt.initEvent("keyup",!1,!0),element[0].dispatchEvent(evt)}})}}}]).directive("cardName",["$compile",function($compile){return{restrict:"A",scope:{ngModel:"="},require:["^card","ngModel"],link:function(scope,element,attributes,ctrls){var cardCtrl=ctrls[0];cardCtrl.nameInput=element,scope.$watch("ngModel",function(newVal,oldVal){if((oldVal||newVal)&&(oldVal!==newVal||newVal)){var evt=document.createEvent("HTMLEvents");evt.initEvent("keyup",!1,!0),element[0].dispatchEvent(evt)}})}}}]).directive("cardExpiry",["$compile",function($compile){return{restrict:"A",scope:{ngModel:"="},require:["^card","ngModel"],link:function(scope,element,attributes,ctrls){var cardCtrl=ctrls[0];cardCtrl.expiryInput=element,scope.$watch("ngModel",function(newVal,oldVal){if((oldVal||newVal)&&(oldVal!==newVal||newVal)){var evt=document.createEvent("HTMLEvents");evt.initEvent("keyup",!1,!0),element[0].dispatchEvent(evt)}})}}}]).directive("cardCvc",["$compile",function($compile){return{restrict:"A",scope:{ngModel:"="},require:["^card","ngModel"],link:function(scope,element,attributes,ctrls){var cardCtrl=ctrls[0];cardCtrl.cvcInput=element,scope.$watch("ngModel",function(newVal,oldVal){if((oldVal||newVal)&&(oldVal!==newVal||newVal)){var evt=document.createEvent("HTMLEvents");evt.initEvent("keyup",!1,!0),element[0].dispatchEvent(evt)}})}}}]);